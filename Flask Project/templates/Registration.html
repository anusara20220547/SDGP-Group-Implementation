<!DOCTYPE html>
<html lang = "en">
    <head>
        <meta charset="UTF-8">
        <title>Voice of Unity Online Petition System</title>
        <link rel="stylesheet" href="../static/Registration Page/styleReg.css">
        <link rel="stylesheet" href="../static/NavigationCSS.css">
        <link rel="stylesheet" href="../static/footer.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>

    <body>

        <header class="header">
            <a href="#" class="logo">Logo</a>
            <i class='bx bx-menu' id="menu-icon"></i>
            <nav class="navbar">
                <a href="../Home Page/Home Page.html">Home</a>
                <a href="#">About</a>
                <a href="#">Contact</a>
                <a href="/loginp" class="login-btn">Log In</a>
                <a href="#" class="signup-btn">Sign Up</a> 
            </nav>
    
        </header>

        <div class= "form-popup">
            <div class="form-box signup">
                <div class="form-details">
                    <h1>Create Account</h1>
                    <p>To become a part of our community, Please sign up using your personal information.</p>
                </div>
                
                <div class="form-content">
                    <h2>Create an account</h2>
                    <h3>Let's get started!</h3>
                    <br/>
                    
                    <form action="" id="authentication">
                        <div class="input-field">
                            <i class="fa-solid fa-user"></i>
                            <lable for="name">Enter your username</lable>
                            <input type="text" id="name" placeholder="Enter your username here" required>  
                        </div>
                        </br>

                        <div class="input-field">
                            <i class="fa-solid fa-envelope"></i>
                            <lable for="gmail">Enter your gmail</lable>
                            <input type="text" id="gmail" placeholder="Enter your gmail here" required>
                        </div>
                        </br>

                        <div class="input-field">
                            <i class="fa-solid fa-lock"></i>
                            <lable for="password">Enter your password</lable>
                            <input type="password" id="password" placeholder="Enter your password here" required>
                        </div>
                        </br>

                        <div class="policy-text">
                            <input type="checkbox" id="policy" required>
                            <lable for="policy">
                                I agree the
                                <a href="#">Terms & Conditions</a>
                            </lable>
                        </div>

                        <br/>

                        <button type="submit">Sign Up</button>
                        
                        <button type="submit" id="ayyo">Continue with Gmail</button>
                        <script src="main.js"></script>
                        <script src="jReg.js"></script> 
                        
                    </form>
                    
                    <br/> 

                    <div class="bottom-link">
                        Already have an account? 
                        <a href="#">Sign In</a>
                    </div>

                </div>
            </div>
        </div>  

        <footer>
            <div class="row">
                <div class="col">
                    <img src="../static/images/logo (2).png" class="footer_logo">
                    <p class="footer_about">Join us in making a difference! Sign up for updates and stay connected.
    
                    </p>
                </div>
                <div class="col">
                    <h3>Contact Us <div class="bottom_line"><span></span></div></h3>
                    <p>2841 Romines Mill Road</p>
                    <p>Plano</p>
                    <p>Texas, ZIP 75074, United States</p>
                    <p class="footer_email">voiceofunityweb@gmail.com</p>
                    <h4>+94 - 715442990</h4>
                </div>
                <div class="col">
                    <h3>Links <div class="bottom_line"><span></span></div></h3>
                    <ul>
                        <li><a href="">HOME</a></li>
                        <li><a href="">LOGIN</a></li>
                        <li><a href="">REGISTER</a></li>
                        <li><a href="">SUPPORT</a></li>
                    </ul>
                </div>
                <div class="col">
                    <h3>Newsletter <div class="bottom_line"><span></span></div></h3>
                    <form>
                        <ion-icon class="icon" name="mail"></ion-icon>
                        <input type="email" placeholder="Enter your email" required>
                        <button type="submit"><ion-icon class="icon_right" name="arrow-round-forward"></ion-icon></button>
                    </form>
                    <div class="social_icons">
                        <ion-icon class="social_icon" name="logo-facebook"></ion-icon>
                        <ion-icon class="social_icon" name="logo-whatsapp"></ion-icon>
                        <ion-icon class="social_icon" name="logo-twitter"></ion-icon>
                        <ion-icon class="social_icon" name="logo-instagram"></ion-icon>
                    </div>
                </div>
            </div>
            <hr>
            <p class="copyright">Voice of Unity â’¸ 2024 - All Rights Reserved</p>
         </footer> 
        <script type="module">
  
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
            import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js";
            
            const firebaseConfig = {
              apiKey: "AIzaSyCHo3GsutqlcVaSrCT3IgyzG6iRce4-egM",
              authDomain: "voc-sdgp.firebaseapp.com",
              databaseURL: "https://voc-sdgp-default-rtdb.firebaseio.com",
              projectId: "voc-sdgp",
              storageBucket: "voc-sdgp.appspot.com",
              messagingSenderId: "158804183426",
              appId: "1:158804183426:web:a814aabef72fd4dcaaa79b"
            };
          
          
            const app = initializeApp(firebaseConfig);
            const auth = getAuth();
            const provider = new GoogleAuthProvider()
          
            const signInButton = document.getElementById("ayyo");
            
          
            const userSignIn = async () => {
            try {
                const result = await signInWithPopup(auth, provider);
                const user = result.user;

                // Save user information in local storage
                localStorage.setItem('userName', user.displayName);
                localStorage.setItem('userGmail', user.email);

                // Proceed to save user information in the database
                saveGoogleSignInDetails(user.displayName, user.email);
                window.location.href = "/updateprofile";

            } catch (error) {
                console.error("Error with Google Sign-In:", error);
            }
        };


        const saveGoogleSignInDetails = (name, gmail) => {
        const contactFormDB = firebase.database().ref('alldata/authentication');

        contactFormDB.orderByChild("gmail").equalTo(gmail).once("value", snapshot => {
            if (!snapshot.exists()) {
                const newAuthenticationRef = contactFormDB.push();

                // Save Google Sign-In user information in the database
                newAuthenticationRef.set({
                    name: name,
                    gmail: gmail,
                    signcount: 0
                }).catch((error) => {
                    console.error("Error uploading authentication data:", error);
                });
            }
        });
    };

          
            
          
            signInButton.addEventListener('click', userSignIn);
          
          </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.14.1-0/firebase.js"></script> 
        <script src="../static/Registration Page/mail.js"></script>
        

    </body>
</html>